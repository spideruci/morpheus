(this["webpackJsonptest-visualization"]=this["webpackJsonptest-visualization"]||[]).push([[0],{113:function(e,t,n){e.exports={footer:"Footer_footer__1G6Wy",social:"Footer_social__PMSlF"}},118:function(e,t,n){e.exports={onLoadDiv:"Morpheus_onLoadDiv__2mnlM",twoColumn:"Morpheus_twoColumn__28gIi"}},205:function(e,t,n){e.exports=n(364)},210:function(e,t,n){e.exports={header:"Navbar_header__1xb0K"}},22:function(e,t,n){e.exports={toolbar:"Toolbar_toolbar__2qWyD",bigMenu:"Toolbar_bigMenu__DBEFr",mediumMenu:"Toolbar_mediumMenu__1LSwB",mediumButton:"Toolbar_mediumButton__3EbIc"}},310:function(e,t,n){},362:function(e,t,n){},363:function(e,t,n){},364:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(12),c=n.n(o),i=n(56),l=n(14),s=n(113),u=n.n(s),m=function(){return r.a.createElement("div",{className:u.a.footer},r.a.createElement("div",{className:u.a.social},r.a.createElement("a",{href:"http://spideruci.org"},r.a.createElement("img",{alt:"spideruci.org",src:"spider_circle_red.svg"})),r.a.createElement("a",{href:"https://github.com/spideruci"},r.a.createElement("img",{alt:"github.com/spideruci",src:"./GitHub-Mark-32px.png"}))))},g=(n(210),function(){return r.a.createElement("nav",null,r.a.createElement(i.b,{to:"/"},r.a.createElement("div",{className:"header"},r.a.createElement("h1",null,"Morpheus"))),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(i.b,{to:"/about"},"About")),r.a.createElement("li",null,r.a.createElement(i.b,{to:"/morpheus"},"Visualization"))))}),f=n(16),h=n(162),p=n.n(h),d=n(163),v=n.n(d),b=(n(310),function(){var e=Object(a.useState)(null),t=Object(f.a)(e,2),n=t[0],o=t[1];return Object(a.useEffect)((function(){v.a.get("".concat("/morpheus","/content/about.md")).then((function(e){return e.data})).then((function(e){return o(e)})).catch(console.error)})),r.a.createElement("div",{className:"content-wrapper"},r.a.createElement(p.a,{source:n}))}),y=n(30),E=function(e){var t=Object(a.useState)(e),n=Object(f.a)(t,2),r=n[0],o=n[1];return Object(a.useEffect)((function(){var t=function(e,t){for(var n=t.filters,a={x:Object(y.a)(e.x),y:Object(y.a)(e.y),edges:Object(y.a)(e.edges)},r=0,o=Object.entries(n);r<o.length;r++){a=(0,Object(f.a)(o[r],2)[1])(a,e)}return a}(function(e,t){var n=e.x,a=e.y,r=e.edges,o=t.sort;return void 0===o.x||void 0===o.y?e:{x:o.x.func(Object(y.a)(n),e,t),y:o.y.func(Object(y.a)(a),e,t),edges:Object(y.a)(r)}}(e.coverage,e),e);o(t)}),[e,e.coverage.x,e.coverage.y,e.coverage.edges,e.sort.x,e.sort.y,e.filters]),r},_=n(43),O=n(47),j=n(57),x=n(164),T=n(174),k=n(416),C=n(418),S=n(401),D=n(29),I=n(402),N=n(79),w=function(e){Object(x.a)(n,e);var t=Object(T.a)(n);function n(e){var a;return Object(_.a)(this,n),(a=t.call(this)).ref=r.a.createRef(),a.state={width:0,height:0},a.margin={top:50,left:50,right:0,bottom:0},a.labelToggle=!!e.hasOwnProperty("labelToggle")&&e.labelToggle,a.createMatrix=a.createMatrix.bind(Object(j.a)(a)),a.createTestMatrixView=a.createTestMatrixView.bind(Object(j.a)(a)),a.update=a.update.bind(Object(j.a)(a)),a.onXClick=e.onXClick,a.onYClick=e.onYClick,a.onRightClick=e.onRightClick,a}return Object(O.a)(n,[{key:"createMatrix",value:function(){var e={x:this.props.coverage.x,y:this.props.coverage.y,edges:this.props.coverage.edges};return 0===e.x.length||0===e.y.length?{x_labels:[],y_labels:[],nodes:[]}:{x_labels:e.x,y_labels:e.y,nodes:e.edges}}},{key:"componentDidMount",value:function(){var e=this,t=this.ref.current.parentElement.offsetWidth,n=this.ref.current.parentElement.offsetHeight;this.state.width===t&&this.state.height===n||this.setState({width:t,height:n},this.update),window.addEventListener("resize",(function(){null!==e.ref.current&&e.setState({width:e.ref.current.parentElement.offsetWidth,height:e.ref.current.parentElement.offsetHeight},e.update)})),this.createTestMatrixView()}},{key:"componentDidUpdate",value:function(e,t,n){this.update()}},{key:"update",value:function(){var e=this.ref.current,t=Object(S.a)(e),n=this.createMatrix();t.attr("viewBox",[0,0,this.state.width,this.state.height]);var a=Object(N.a)().on("zoom",(function(e){Object(S.a)("svg g").attr("transform",e.transform)}));t.call(a),Object(S.a)("svg g").attr("transform","translate(0,0) scale(1.0)");var r=0;r=n.x_labels.length>=n.y_labels.length?1*this.state.width/n.x_labels.length:1*this.state.height/n.y_labels.length;var o=n.x_labels.length*r,c=n.y_labels.length*r,i=o-this.margin.left-this.margin.right-10,l=c-this.margin.top-this.margin.bottom-10,s=Object(C.a)().padding(.5).range([0,i]).domain(n.x_labels.map((function(e){return e.getID()}))),u=Object(C.a)().padding(.5).range([0,l]).domain(n.y_labels.map((function(e){return e.getID()})));function m(e,t){return function(n,a){return n="",e||(n=""),a%t!==0?" ":n}}var g=t.select(".tooltip").style("visibility","visible");function f(e){g.select("text").style("opacity",1),Object(S.a)(this).style("stroke","black")}function h(){var e=Object(S.a)(this).datum(),t="";t=void 0===e.x?e.toString():d(e),g.select("text").attr("x",parseFloat(Object(S.a)(this).attr("x"))+60).attr("y",parseFloat(Object(S.a)(this).attr("y"))+45).text(t)}function p(e){g.select("text").style("opacity",0),Object(S.a)(this).style("stroke","none")}function d(e){var t=n.x_labels.find((function(t){return t.getID()===e.x})).toString(),a=n.y_labels.find((function(t){return t.getID()===e.y})).toString();return"".concat(t," tested by ").concat(a)}g.append("text").attr("id","tooltip-text").attr("dominant-baseline","auto").attr("text-anchor","start").attr("stroke","grey").attr("stroke-opacity","0.3").attr("stroke-width","5").attr("fill","black").style("font-size","12px").style("opacity",0).html("");var v=n.x_labels.length<=20?1:n.x_labels.length/20,b=n.y_labels.length<=20?1:n.x_labels.length/20,y=n.x_labels.length<=20&&this.labelToggle,E=n.y_labels.length<=20&&this.labelToggle,_=Object(k.b)().tickFormat(m(y,v)).scale(s),O=Object(k.a)().tickFormat(m(E,b)).scale(u),j=Object(D.b)().duration(0).ease(I.a),x=s.step(),T=u.step(),w=Object(S.a)("g.testmatrix").attr("transform","translate(".concat(this.margin.left,", ").concat(this.margin.top,")")).selectAll(".cell").data(n.nodes).join((function(e){return e.append("rect").call((function(e){return e.transition(j).attr("x",(function(e){return s(e.getX())-x/2})).transition(j).attr("y",(function(e){return u(e.getY())-T/2}))}))}),(function(e){return e.call((function(e){return e.transition(j).attr("x",(function(e){return s(e.getX())-x/2})).transition(j).attr("y",(function(e){return u(e.getY())-T/2}))}))}),(function(e){return e.remove()})).attr("class","cell").attr("fill",(function(e){return e.getColor()})).attr("width",x).attr("height",T).attr("rx",Math.max(1,s.step()/2)).attr("stroke",(function(e){return e.getProperty("highlight")?"black":null})).attr("stoke-width",(function(e){return e.getProperty("highlight")?"1px":"0px"})).on("mouseover",f).on("mousemove",h).on("mouseleave",p);w.selectAll("*").remove(),w.append("title").text(d),Object(S.a)("g.x-axis").attr("transform","translate(".concat(this.margin.left,", ").concat(this.margin.top,")")).call(_).selectAll("line").style("stroke","white").style("stroke-width","0.0"),Object(S.a)("g.x-axis").select("path").style("stroke","grey").style("stroke-width","0.5");var L=x-.1*x,M=function(e){var t=e.id;return n.nodes.filter((function(e){return e.x===t})).length};Object(S.a)("g.x-axis").selectAll(".axis-dots-x").data(n.x_labels).join((function(e){return e.append("rect").call((function(e){return e.attr("x",(function(e){return"".concat(s(e.getID())-L/2,"px")}))}))}),(function(e){return e.call((function(e){return e.attr("x",(function(e){return"".concat(s(e.getID())-L/2,"px")}))}))}),(function(e){return e.remove()})).attr("class","axis-dots-x").attr("y",(function(e){return-M(e)})).attr("height",M).attr("width",L).style("stroke","black").style("stroke-width","0.0").style("fill",(function(e){return e.getColor()})).on("click",this.onXClick).on("contextmenu",this.onRightClick).on("mouseover",f).on("mousemove",h).on("mouseleave",p),Object(S.a)("g.y-axis").attr("transform","translate(".concat(this.margin.left,", ").concat(this.margin.top,")")).call(O).selectAll("line").style("stroke","white").style("stroke-width","0.0"),Object(S.a)("g.y-axis").select("path").style("stroke","grey").style("stroke-width","0.5");var P=T-.1*T,R=function(e){var t=e.id;return n.nodes.filter((function(e){return e.y===t})).length};Object(S.a)("g.y-axis").selectAll(".axis-dots-y").data(n.y_labels).join((function(e){return e.append("rect").call((function(e){return e.attr("y",(function(e){return"".concat(u(e.getID())-P/2,"px")}))}))}),(function(e){return e.call((function(e){return e.attr("y",(function(e){return"".concat(u(e.getID())-P/2,"px")}))}))}),(function(e){return e.remove()})).attr("class","axis-dots-y").attr("x",(function(e){return-R(e)})).attr("width",R).attr("height",P).style("stroke","black").style("stroke-width","0").style("fill",(function(e){return e.getColor()})).on("click",this.onYClick).on("contextmenu",this.onRightClick).on("mouseover",f).on("mousemove",h).on("mouseleave",p),t.select(".xlabel").attr("x",this.state.width/2).attr("y",11).style("text-anchor","middle").text(this.props.xLabel),t.select(".ylabel").attr("transform","rotate(-90)").attr("y",1).attr("x",-this.state.height/2).attr("dy","0.7em").style("text-anchor","middle").text(this.props.yLabel)}},{key:"createTestMatrixView",value:function(){var e=this.ref.current,t=Object(S.a)(e);t.attr("viewBox",[0,0,this.state.width,this.state.height]);var n=t.append("g");n.append("g").attr("class","x-axis"),n.append("g").attr("class","y-axis"),n.append("g").attr("class","testmatrix"),n.append("g").attr("class","tooltip"),t.append("text").attr("class","xlabel"),t.append("text").attr("class","ylabel")}},{key:"render",value:function(){return r.a.createElement("div",{style:{width:"100%",height:"100%"}},r.a.createElement("svg",{ref:this.ref}))}}]),n}(a.Component),L=n(64),M=Object({NODE_ENV:"production",PUBLIC_URL:"/morpheus",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).hasOwnProperty("REACT_APP_API_ENDPOINT")?Object({NODE_ENV:"production",PUBLIC_URL:"/morpheus",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API_ENDPOINT:"http://localhost:8000",P={fetchProjects:function(){return"".concat(M,"/projects")},fetchCommits:function(e){return"".concat(M,"/projects/").concat(e,"/commits")},fetchCoverage:function(e,t){return"".concat(M,"/coverage/projects/").concat(e,"/commits/").concat(t)},fetchTestHistory:function(e,t){return"".concat(M,"/coverage/projects/").concat(e,"/tests/").concat(t)},fetchMethodHistory:function(e,t){return"".concat(M,"/coverage/projects/").concat(e,"/methods/").concat(t)}},R=function(e){return console.debug("[API_CALL]: ".concat(e)),e},A=Object({NODE_ENV:"production",PUBLIC_URL:"/morpheus",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).hasOwnProperty("REACT_APP_REST_API")?P:{fetchProjects:function(){return"".concat("/morpheus","/data/projects.json")},fetchCommits:function(e){return"".concat("/morpheus","/data/projects/").concat(e,"/commits.json")},fetchCoverage:function(e,t){return"".concat("/morpheus","/data/coverage/projects/").concat(e,"/commits/").concat(t,".json")},fetchTestHistory:function(e,t){return"".concat("/morpheus","/data/coverage/projects/").concat(e,"/tests/").concat(t,".json")},fetchMethodHistory:function(e,t){return"".concat("/morpheus","/data/coverage/projects/").concat(e,"/methods/").concat(t,".json")}},H=function e(t,n){var a=this;Object(_.a)(this,e),this.getProjectName=function(){return a.name},this.getID=function(){return a.id},this.toString=function(){return a.name},this.name=t,this.id=n},Y=function(){function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(_.a)(this,e),this.x=parseInt(t),this.y=parseInt(n),this.properties=a}return Object(O.a)(e,[{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"getColor",value:function(){return this.getProperty("test_result")?"#03C03C":"#FF1C00"}},{key:"toString",value:function(){return"<Edge x:".concat(this.x,", y:").concat(this.y,">")}},{key:"getProperty",value:function(e){return e in this.properties?this.properties[e]:null}},{key:"setProperty",value:function(e,t){this.properties[e]=t}}]),e}(),F=function(){function e(t,n,a,r,o,c){Object(_.a)(this,e),this.id=parseInt(t),this.packageName=n,this.className=a,this.methodName=r,this.methodDecl=o,this.filePath=c}return Object(O.a)(e,[{key:"getID",value:function(){return this.id}},{key:"getColor",value:function(){return"black"}},{key:"getPackageName",value:function(){return this.packageName}},{key:"getClassName",value:function(){return this.className}},{key:"getMethodName",value:function(){return this.methodDecl}},{key:"toString",value:function(){return"".concat(this.packageName," ").concat(this.className," ").concat(this.methodDecl)}}]),e}(),U=function(){function e(t,n,a,r){Object(_.a)(this,e),this.id=parseInt(t),this.packageName=n,this.className=a,this.testName=r,this.properties={}}return Object(O.a)(e,[{key:"getID",value:function(){return this.id}},{key:"getColor",value:function(){return"black"}},{key:"getPackageName",value:function(){return this.packageName}},{key:"getClassName",value:function(){return this.className}},{key:"getMethodName",value:function(){return this.testName}},{key:"toString",value:function(){return"".concat(this.packageName," ").concat(this.className," ").concat(this.testName)}},{key:"getProperty",value:function(e){return e in this.properties?this.properties[e]:null}},{key:"setProperty",value:function(e,t){this.properties[e]=t}}]),e}(),V=function(){function e(t,n,a,r){Object(_.a)(this,e),this.id=t,this.sha=n,this.date=new Date(a),this.author=r}return Object(O.a)(e,[{key:"getID",value:function(){return this.id}},{key:"getColor",value:function(){return"black"}},{key:"getAuthor",value:function(){return this.author}},{key:"getDate",value:function(){return this.date}},{key:"getSHA",value:function(){return this.sha}},{key:"toString",value:function(){var e=this.sha.slice(this.sha.length-7,this.sha.length),t=this.date.toDateString();return"".concat(e,", ").concat(t)}}]),e}(),z=n(22),X=n.n(z),B=n(415),W=n(413),G=n(414),K=n(420),J=n(403),q=n(7),Q=n(117),Z="REDO",$="UNDO",ee="RESET";function te(e,t,n){var a=new Map;return e.forEach((function(e){var r=t(e),o=n(e);if(a.has(r)){var c=a.get(r);c.add(o),a.set(r,c)}else{var i=new Set;i.add(o),a.set(r,i)}})),a}function ne(e,t,n){return e.sort((function(e,t){return e.toString()>t.toString()}))}function ae(e,t,n){var a,r=te(t.edges,(function(e){return e.getX()}),(function(e){return e.getY()}));return a=r,e.sort((function(e,t){var n=e.getID(),r=t.getID(),o=a.has(n)?a.get(n).size:0,c=a.has(r)?a.get(r).size:0;return o<c?1:o>c?-1:0}))}function re(e,t,n){var a=new Map,r=te(n.coverage.edges,(function(e){return e.method_id}),(function(e){return e.test_id})),o=new Map;n.coverage.edges.forEach((function(e){var t=e.test_id,n=e.getProperty("test_result");o.set(t,n)}));var c=0,i=0;return o.forEach((function(e,t){console.log(e),e?i+=1:c+=1})),0===c||i===n.coverage.y.length-1?(console.warn("No info to compute suspiciousness, so sort by methods name."),ne(e)):(n.coverage.x.forEach((function(e){a.set(e.getID(),function(e){var t=0,n=0;return r.has(e.getID())?(r.get(e.getID()).forEach((function(e){o.has(e)&&o.get(e)?t+=1:n+=1})),n/c/(t/i+n/c)):-1}(e))})),e.sort((function(e,t){var n=a.get(e.getID()),r=a.get(t.getID());return n<r?1:n>r?-1:0})))}function oe(e,t,n){return e.sort((function(e,t){return e.toString()>t.toString()}))}function ce(e,t,n){var a,r=te(t.edges,(function(e){return e.getY()}),(function(e){return e.getX()}));return a=r,e.sort((function(e,t){var n=e.getID(),r=t.getID(),o=a.has(n)?a.get(n).size:0,c=a.has(r)?a.get(r).size:0;return o<c?1:o>c?-1:0}))}function ie(e,t){return e.sort((function(e,t){return e.getDate()>t.getDate()}))}var le=n(33),se=n(419),ue=n(170),me={TEST_RESULT:"Test Result",TEST_TYPE:"Test Type"},ge=function(e,t,n,a){if(console.log("SET COLOR",e,t),"COVERAGE"===t){if(e===me.TEST_RESULT||null===e){var r=n.x,o=n.y,c=n.edges;fe.package_name({methods:r}),he.package_name({tests:o}),pe.test_result({edges:c})}else if(e===me.TEST_TYPE){var i=n.x,l=n.y,s=function(e,t){var n,a=e.edges,r=t.x,o=t.y,c=[],i=Object(le.a)(r);try{for(i.s();!(n=i.n()).done;){var l=n.value;l.boo=Math.random(),c.push(l)}}catch(g){i.e(g)}finally{i.f()}var s=te(a,(function(e){return e.getY()}),(function(e){return e.getX()})),u=new Map,m=new Map;return r.forEach((function(e){m.set(e.getID(),e)})),o.forEach((function(e,t,n){var a=e.getID(),r=s.get(a),o=new Set,c=new Set;r.forEach((function(e){var t=m.get(e);if(void 0!==t){var n=t.getPackageName(),a=t.getClassName();o.add(n),c.add("".concat(n,".").concat(a))}})),o.size>1?u.set(e.getID(),"S"):1===o.size&&c.size>1?u.set(e.getID(),"I"):1===c.size&&u.set(e.getID(),"U")})),u}(a,n);fe.package_name({methods:i}),he.package_name({tests:l}),pe.test_type({test_type_map:s})}}else if("METHOD_HISTORY"===t){var u=n.y,m=n.edges;he.package_name({tests:u}),pe.test_result({edges:m})}else if("TEST_HISTORY"===t){var g=n.y,f=n.edges;fe.package_name({methods:g}),pe.test_result({edges:f})}else console.warn("Coverage type ".concat(t," not found..."))},fe={package_name:function(e){var t=e.methods;if(t.length>0&&t[0].constructor.name===F.name){var n=new Set(t.map((function(e){return e.getPackageName()})));F.prototype.getColor=function(){return e=this.getPackageName(),Object(ue.a)(se.a).domain(Array.from(n))(e);var e}}}},he={package_name:function(e){var t=e.tests;if(t.length>0&&t[0].constructor.name===U.name){var n=new Set(t.map((function(e){return e.getPackageName()})));U.prototype.getColor=function(){return e=this.getPackageName(),Object(ue.a)(se.a).domain(Array.from(n))(e);var e}}},test_type:function(e){var t=e.test_type_map;U.prototype.getColor=function(){switch(t.get(this.getID())){case"S":return"#0575eb";case"I":return"#eb8c06";case"U":return"#02ae5e";default:return"black"}}}},pe={test_result:function(e){var t=e.edges;t.length>0&&t[0].constructor.name===Y.name&&(Y.prototype.getColor=function(){return this.getProperty("test_result")?"#03C03C":"#FF1C00"})},test_type:function(e){var t=e.test_type_map;Y.prototype.getColor=function(){switch(t.get(this.getY())){case"S":return"#0575eb";case"I":return"#eb8c06";case"U":return"#02ae5e";default:return"black"}}}};var de="LOADING",ve="SET_PROJECT",be="SET_COMMIT",ye="SET_COLOR_SCHEME",Ee="SET_METHOD_HISTORY",_e="SET_TEST_HISTORY",Oe="SET_SORT",je="ADD_FILTER",xe="SET_COVERAGE",Te="POP_UP",ke=function(e,t){switch(console.log("MORPHEUS REDUCER",e,t),t.type){case de:return Object(q.a)({},e);case ve:return console.log(ve,e,t),Object(q.a)(Object(q.a)({},e),{},{info:Object(q.a)(Object(q.a)({},e.info),{},{project:t.project})});case be:return console.log(be,e,t),Object(q.a)(Object(q.a)({},e),{},{info:Object(q.a)(Object(q.a)({},e.info),{},{type:"COVERAGE",commit:t.commit}),color_scheme:me.TEST_RESULT});case Ee:var n={type:"METHOD_HISTORY",method:t.state.info.label,project:e.info.project};return Object(q.a)(Object(q.a)({},e),{},{info:Object(q.a)({},n),pop_up:{isVisible:!1,label:null,anchor:null}});case _e:var a={type:"TEST_HISTORY",test:t.state.info.label,project:e.info.project};return Object(q.a)(Object(q.a)({},e),{},{info:Object(q.a)({},a),pop_up:{isVisible:!1,label:null,anchor:null}});case Oe:return console.log(Oe,e,t),Object(q.a)(Object(q.a)({},e),{},{sort:Object(q.a)(Object(q.a)({},e.sort),t)});case je:return console.log(je,e,t),Object(q.a)(Object(q.a)({},e),{},{filters:Object(q.a)(Object(q.a)({},e.filters),t.filters)});case xe:console.log(xe,t,e);var r={name:"NAME",func:ne},o={name:"NAME",func:oe};return"METHOD_HISTORY"!==e.info.type&&"TEST_HISTORY"!==e.info.type||(r={name:"DATE",func:ie}),Object(q.a)(Object(q.a)(Object(q.a)({},e),t.state),{},{coverage:Object(q.a)({},t.state.coverage),sort:{x:r,y:o},pop_up:{isVisible:!1,label:null,anchor:null}});case Te:return console.log(Te,t,e),Object(q.a)(Object(q.a)({},e),{},{pop_up:Object(q.a)({},t.pop_up)});case ye:return console.log(ye,t,e),Object(q.a)(Object(q.a)({},e),{},{color_scheme:t.color_scheme});default:return console.log("DEFAULT RETURN state",e),e}},Ce=function(e){var t=e.methods,n=e.tests,a=e.edges;return{x:t.map((function(e){return new F(e.id,e.package_name,e.class_name,e.method_name,e.method_decl,e.file_path)})),y:n.map((function(e){return new U(e.id,e.package_name,e.class_name,e.method_name)})),edges:a.map((function(e){return new Y(e.method_id,e.test_id,{test_result:e.test_result})}))}},Se=function(e){var t=e.commits,n=e.tests,a=e.edges;return{x:t.map((function(e){return new V(e.id,e.sha,e.datetime,e.author)})),y:n.map((function(e){return new U(e.id,e.package_name,e.class_name,e.method_name)})),edges:a.map((function(e){return new Y(e.commit_id,e.test_id,{test_result:e.test_result})}))}},De=function(e){var t=e.methods,n=e.commits,a=e.edges;return{x:n.map((function(e){return new V(e.id,e.sha,e.datetime,e.author)})),y:t.map((function(e){return new F(e.id,e.package_name,e.class_name,e.method_name,e.method_decl,e.file_path)})),edges:a.map((function(e){return new Y(e.commit_id,e.method_id,{test_result:e.test_result})}))}},Ie=function(e){var t=function(e,t){var n={past:[],present:t,future:[]};return[n,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,a=arguments.length>1?arguments[1]:void 0,r=t.past,o=t.present,c=t.future;switch(a.type){case $:var i=Object(Q.a)(r),l=i[0],s=i.slice(1);return 3===r.length?(console.warn("No more history state"),t):{past:s,present:l,future:[o].concat(Object(y.a)(c))};case Z:if(c.length<1)return console.warn("No more future states to apply."),t;var u=Object(Q.a)(c),m=u[0],g=u.slice(1);return{past:[o].concat(Object(y.a)(r)),present:m,future:g};case ee:if(console.log("RESET",t),r.length<=3)return console.warn("No state to return yet.",t),t;var f=r.slice(r.length-3-1,r.length-1),h=r[r.length-3-1];return{past:f,present:h,future:[]};default:var p=e(o,a);return o===p?t:{past:[o].concat(Object(y.a)(r)),present:p,future:[]}}}]}(ke,e),n=Object(f.a)(t,2),r=n[0],o=n[1],c=Object(a.useReducer)(o,r),i=Object(f.a)(c,2),l=i[0],s=i[1],u=l.present;return Object(a.useEffect)((function(){var e,t,n=u.info,a=n.type,r=n.project;switch(a){case"COVERAGE":var o=u.info.commit;(e=r.getID(),t=o.getID(),Object(L.a)(R(A.fetchCoverage(e,t))).then((function(e){var t=e.coverage.methods,n=e.coverage.tests,a=e.coverage.edges;return 0!==t.length&&0!==n.length&&0!==a.length||console.error("Nothing to visualize, methods: ".concat(t.length,", tests: ").concat(n.length,", edges: ").concat(a.length)),{methods:t,tests:n,edges:a}})).catch(console.error)).then(Ce).then((function(e){s({type:xe,state:{isLoading:!1,coverage:e}})})).catch(console.error);break;case"TEST_HISTORY":var c=u.info.test;(function(e,t){return Object(L.a)(R(A.fetchTestHistory(e,t))).then((function(e){var t=e.coverage.methods,n=e.coverage.commits,a=e.coverage.edges;return 0!==t.length&&0!==n.length&&0!==a.length||console.error("Nothing to visualize, methods: ".concat(t.length,", commits: ").concat(n.length,", edges: ").concat(a.length)),{methods:t,commits:n,edges:a}})).catch(console.error)})(r.getID(),c.getID()).then(De).then((function(e){s({type:xe,state:{isLoading:!1,coverage:e}})})).catch(console.error);break;case"METHOD_HISTORY":var i=u.info.method;(function(e,t){return Object(L.a)(R(A.fetchMethodHistory(e,t))).then((function(e){var t=e.coverage.tests,n=e.coverage.commits,a=e.coverage.edges;return 0!==t.length&&0!==n.length&&0!==a.length||console.error("Nothing to visualize, methods: ".concat(t.length,", commits: ").concat(n.length,", edges: ").concat(a.length)),{tests:t,commits:n,edges:a}})).catch(console.error)})(r.getID(),i.getID()).then(Se).then((function(e){s({type:xe,state:{isLoading:!1,coverage:e}})})).catch(console.error);break;default:return}}),[u.info,u.info.project,u.info.commit]),[l,s]},Ne={isLoading:!0,info:{type:"DEFAULT",project:null},pop_up:{isVisible:!1,label:null,anchor:null},filters:{},color_scheme:null,sort:{x:{name:"NAME",func:ne},y:{name:"NAME",func:oe}},coverage:{x:[],y:[],edges:[]}},we=Object(a.createContext)(null),Le=function(e){var t=Ie(Ne),n=Object(f.a)(t,2),a=n[0],o=n[1];return r.a.createElement(we.Provider,{value:{state:a.present,dispatch:o}},e.children)},Me=function(e){return function(t,n){var a=t.x,r=t.y,o=t.edges,c=a.find((function(t){return t.getMethodName()===e.getMethodName()}));if(void 0===c)return t;var i=o.filter((function(e){return e.getX()===parseInt(c.getID())})).map((function(e){return e.getY()})),l=r.filter((function(e){return i.includes(parseInt(e.getID()))})),s=l.map((function(e){return parseInt(e.getID())})),u=o.filter((function(e){return s.includes(e.getY())})),m=u.map((function(e){return e.getX()}));return{x:a.filter((function(e){return m.includes(parseInt(e.getID()))})),y:l,edges:u}}},Pe={ALL:"All",UNIT:"Unit",INTEGRATION:"Integration",SYSTEM:"System"},Re=function(e){return function(t,n){var a;switch(e){case Pe.UNIT:a=function(e,t){return 1===t.size};break;case Pe.INTEGRATION:a=function(e,t){return 1===e.size&&t.size>1};break;case Pe.SYSTEM:a=function(e,t){return e.size>1};break;default:return t}return function(e,t,n){var a,r,o,c=e.x,i=e.y,l=e.edges,s=function(e){var t=new Map;return e.forEach((function(e){t.set(e.getID(),e)})),t}(c),u=te(t.edges,(function(e){return e.getY()}),(function(e){return e.getX()}));a=i.filter((function(e){var t=u.get(e.getID()),a=new Set,r=new Set;return t.forEach((function(e){var t=s.get(e);void 0!==t&&(a.add(t.getPackageName()),r.add("".concat(t.getPackageName(),".").concat(t.getClassName())))})),n(a,r)})),o=a.map((function(e){return e.getID()}));var m=(r=l.filter((function(e){return o.includes(e.getY())}))).map((function(e){return e.getX()}));return{x:c.filter((function(e){return m.includes(e.getID())})),y:a,edges:r}}(t,n,a)}};function Ae(e){return function(t,n){var a=t.x,r=t.y,o=t.edges,c=e.getID(),i=r.find((function(e){return e.getID()===parseInt(c)}));if(void 0===i)return console.error("Filter Method was not found..."),t;var l=i.getID(),s=o.filter((function(e){return l===e.getY()})).map((function(e){return e.getX()})),u=a.filter((function(e){return s.includes(e.getID())})),m=o.filter((function(e){return s.includes(e.getX())||e.getY()===l}));m.forEach((function(e){e.test_id===l&&(e.highlight=!0)}));var g=m.map((function(e){return e.getY()}));return{x:u,y:r.filter((function(e){return g.includes(e.getID())})),edges:m}}}var He=function(e){var t=e.onReset,n=e.onUndo,a=e.onRedo,o=e.children;return r.a.createElement("div",{className:X.a.toolbar},r.a.createElement("h4",null,"Toolbar"),o,r.a.createElement(J.a,{onClick:t},"Reset"),r.a.createElement(J.a,{onClick:n},"Undo"),r.a.createElement(J.a,{onClick:a},"Redo"))},Ye=function(){var e=Object(a.useContext)(we),t=e.state,n=e.dispatch;return r.a.createElement(He,{onReset:function(){return n({type:ee})},onUndo:function(){return n({type:$})},onRedo:function(){return n({type:Z})}},r.a.createElement(Ve,{onChange:n,project:t.info.project,commit:t.info.commit}),r.a.createElement("hr",null),r.a.createElement(ze,{isLoading:t.isLoading,onChange:n}),r.a.createElement("hr",null),r.a.createElement("h4",{style:{margin:"5px"}},"Filters"),r.a.createElement(Ge,{methods:t.coverage.x,onChange:n,isLoading:t.isLoading,valueX:t.sort.x.name,valueY:t.sort.y.name}),r.a.createElement(Ke,{tests:t.coverage.y,onChange:n,isLoading:t.isLoading}),r.a.createElement("hr",null),r.a.createElement(We,{onChange:n,isLoading:t.isLoading}),r.a.createElement("hr",null),r.a.createElement(qe,{project:t.info.project,commit:t.info.commit}))},Fe=function(){var e=Object(a.useContext)(we),t=e.state,n=e.dispatch;return r.a.createElement(He,{onReset:function(){return n({type:ee})},onUndo:function(){return n({type:$})},onRedo:function(){return n({type:Z})}},r.a.createElement(Ve,{onChange:n,project:t.info.project,commit:t.info.commit}),r.a.createElement("hr",null),r.a.createElement(Xe,{isLoading:t.isLoading,onChange:n}),r.a.createElement("hr",null),r.a.createElement(Qe,{project:t.info.project,method:t.info.method}))},Ue=function(){var e=Object(a.useContext)(we),t=e.state,n=e.dispatch;return r.a.createElement(He,{onReset:function(){return n({type:ee})},onUndo:function(){return n({type:$})},onRedo:function(){return n({type:Z})}},r.a.createElement(Ve,{onChange:n,project:t.info.project,commit:t.info.commit}),r.a.createElement("hr",null),r.a.createElement(Be,{isLoading:t.isLoading,onChange:n}),r.a.createElement("hr",null),r.a.createElement(Ze,{project:t.info.project,test:t.info.test}))},Ve=function(e){var t=e.onChange,n=e.project,o=e.commit,c=Object(a.useState)([]),i=Object(f.a)(c,2),l=i[0],s=i[1],u=Object(a.useState)([]),m=Object(f.a)(u,2),g=m[0],h=m[1];Object(a.useEffect)((function(){Object(L.a)(R(A.fetchProjects())).then((function(e){return e.projects})).catch(console.error).then((function(e){return e.map((function(e){return new H(e.project_name,e.id)}))})).then(s).catch(console.error)}),[]);return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(W.a,{className:X.a.mediumButton,value:n,disableClearable:!0,options:l,getOptionLabel:function(e){return void 0===e?"":e.toString()},onChange:function(e){var n,a=e.target.innerHTML,r=l.find((function(e){return e.getProjectName()===a}));t({type:ve,project:r}),(n=r.getID(),Object(L.a)(R(A.fetchCommits(n))).then((function(e){return e.commits}))).then((function(e){return e.map((function(e){return new V(e.id,e.sha,e.datetime,e.author)})).sort((function(e,t){return e.getDate()-t.getDate()}))})).then(h).catch((function(e){console.error(e),h([])}))},renderInput:function(e){return r.a.createElement(B.a,Object.assign({},e,{label:"Projects...",variant:"outlined"}))},style:{flex:"1",margin:"2px"}}),r.a.createElement(W.a,{className:X.a.mediumButton,value:o,disableClearable:!0,disabled:0===g.length,options:g,getOptionLabel:function(e){return void 0===e?"":e.toString()},onChange:function(e){var n=e.target.innerHTML,a=g.find((function(e){return e.toString()===n}));t({type:be,commit:a})},renderInput:function(e){return r.a.createElement(B.a,Object.assign({},e,{label:"Commits...",variant:"outlined"}))},style:{flex:"1",margin:"2px"}}))},ze=function(e){var t=e.onChange,n=e.isLoading,a=e.valueX,o=e.valueY,c={Name:ne,Coverage:ae,Suspiciousness:re},i=Object.keys(c),l={Name:oe,Coverage:ce},s=Object.keys(l);return r.a.createElement("div",{style:{margin:"5px"}},r.a.createElement("h4",null,"Sorting"),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{flex:"1",margin:"2px"}},r.a.createElement("h6",null,"Sort Methods"),r.a.createElement(G.a,{className:X.a.mediumMenu,defaultValue:void 0!==a?a:"Name",onChange:function(e){t({type:Oe,x:{name:e.target.value,func:c[e.target.value]}})},disabled:n},i.map((function(e,t){return r.a.createElement(K.a,{key:t,value:e},e)})))),r.a.createElement("div",{style:{flex:"1",margin:"2px"}},r.a.createElement("h6",null,"Sort Tests"),r.a.createElement(G.a,{className:X.a.mediumMenu,defaultValue:void 0!==o?o:"Name",onChange:function(e){t({type:Oe,y:{name:e.target.value,func:l[e.target.value]}})},disabled:n},s.map((function(e,t){return r.a.createElement(K.a,{key:t,value:e},e)}))))))},Xe=function(e){var t=e.onChange,n=e.isLoading,a=(e.valueX,e.valueY),o={Name:oe},c=Object.keys(o);return r.a.createElement("div",{style:{margin:"5px"}},r.a.createElement("h4",null,"Sort Tests"),r.a.createElement(G.a,{className:X.a.mediumMenu,defaultValue:void 0!==a?a:"Name",onChange:function(e){t({type:Oe,y:{name:e.target.value,func:o[e.target.value]}})},disabled:n},c.map((function(e,t){return r.a.createElement(K.a,{key:t,value:e},e)}))))},Be=function(e){var t=e.onChange,n=e.isLoading,a=(e.valueX,e.valueY),o={Name:ne},c=Object.keys(o);return r.a.createElement("div",{style:{margin:"5px"}},r.a.createElement("h4",null,"Sort Methods"),r.a.createElement(G.a,{className:X.a.mediumMenu,defaultValue:void 0!==a?a:"Name",onChange:function(e){t({type:Oe,y:{name:e.target.value,func:o[e.target.value]}})},disabled:n},c.map((function(e,t){return r.a.createElement(K.a,{key:t,value:e},e)}))))},We=function(e){var t=e.onChange,n=e.isLoading,a=Object.values(me);return r.a.createElement("div",{style:{margin:"5px"}},r.a.createElement("h4",null,"Select Color Scheme"),r.a.createElement(G.a,{className:X.a.mediumMenu,defaultValue:me.TEST_RESULT,onChange:function(e){var n=e.target.value;t({type:ye,color_scheme:n})},disabled:n},a.map((function(e,t){return r.a.createElement(K.a,{key:t,value:e},e)}))))},Ge=function(e){var t=e.onChange,n=e.methods;return r.a.createElement(W.a,{className:X.a.bigMenu,id:"project-menu",disableClearable:!0,disabled:0===n.length,options:n,getOptionLabel:function(e){return e.toString()},onChange:function(e){var a=e.target.innerHTML,r=n.find((function(e){return e.toString()===a}));void 0!==r?t({type:je,filters:{METHOD_FILTER:Me(r)}}):console.warn("Method not found in methods",n,a)},renderInput:function(e){return r.a.createElement(B.a,Object.assign({},e,{label:"Filter: Method name",variant:"outlined"}))},style:{margin:"5px"}})},Ke=function(e){var t=e.onChange,n=e.tests,a=e.isLoading,o={All:"All",Passed:"Passed",Failed:"Failed"},c=Object.values(o),i=Object.values(Pe);return r.a.createElement("div",null,r.a.createElement(W.a,{className:X.a.bigMenu,id:"project-menu",disableClearable:!0,disabled:0===n.length,options:n,getOptionLabel:function(e){return e.toString()},onChange:function(e){var a=e.target.innerHTML,r=n.find((function(e){return e.toString()===a}));void 0!==r?t({type:je,filters:{TEST_FILTER:Ae(r)}}):console.warn("Test not found in tests",n,a)},renderInput:function(e){return r.a.createElement(B.a,Object.assign({},e,{label:"Filter: Test name",variant:"outlined"}))},style:{margin:"5px"}}),r.a.createElement("div",{style:{display:"flex",margin:"5px"}},r.a.createElement("div",{style:{flex:"1",padding:"2px"}},r.a.createElement("h6",null,"Test Result: "),r.a.createElement(G.a,{className:X.a.mediumMenu,defaultValue:o.All,onChange:function(e){var n,a=e.target.value,r=void 0;a!==o.Passed&&a!==o.Failed||(r=a===o.Passed),t({type:je,filters:{TEST_RESULT:(n=r,function(e,t){var a=e.x,r=e.y,o=e.edges;if("boolean"!==typeof n)return e;var c=o.filter((function(e){return e.getProperty("test_result")===n})),i=c.map((function(e){return parseInt(e.getY())}));return{x:a,y:r.filter((function(e){return i.includes(parseInt(e.getID()))})),edges:c}})}})},disabled:a},c.map((function(e,t){return r.a.createElement(K.a,{key:t,value:e.toString()},e.toString())})))),r.a.createElement("div",{style:{flex:"1",padding:"2px"}},r.a.createElement("h6",null,"Test Type: "),r.a.createElement(G.a,{className:X.a.mediumMenu,defaultValue:Pe.ALL,onChange:function(e){t({type:je,filters:{TEST_TYPE:Re(e.target.value)}})},disabled:a},i.map((function(e,t){return r.a.createElement(K.a,{key:t,value:e.toString()},e)}))))))},Je=function(e){var t=e.project,n=e.children;return null===t?null:r.a.createElement("div",null,r.a.createElement("h3",null,"Project: ",t.toString()),n)},qe=function(e){var t=e.project,n=e.commit;return void 0===n?null:r.a.createElement(Je,{project:t},r.a.createElement("p",null,"SHA: ",n.getSHA()),r.a.createElement("p",null,"Author: ",n.getAuthor()),r.a.createElement("p",null,"Date: ",n.getDate().toISOString()))},Qe=function(e){var t=e.project,n=e.method;return void 0===n?null:r.a.createElement(Je,{project:t},r.a.createElement("p",null,r.a.createElement("b",null,"Method Decl:",n.getMethodName())),r.a.createElement("p",null,"Package: ",n.getPackageName()),r.a.createElement("p",null,"Class: ",n.getClassName()))},Ze=function(e){var t=e.project,n=e.test;return void 0===n?null:r.a.createElement(Je,{project:t},r.a.createElement("p",null,r.a.createElement("b",null,"Testcase: ",n.getMethodName())),r.a.createElement("p",null,"Package: ",n.getPackageName()),r.a.createElement("p",null,"Class: ",n.getClassName()))},$e=n(411),et=(n(313),n(412)),tt=n(173),nt=n.n(tt),at=function(e){var t=e.children,n=e.anchor,a=e.setAnchor,o=e.title,c=e.onFilterClick,i=e.onHistoryClick,l=e.secondaryBtn,s=void 0===l?"Filter by (default)":l,u=e.primaryBtn,m=void 0===u?"Filter":u;return r.a.createElement(et.a,{id:Boolean(n)?"simple-popover":void 0,open:Boolean(n),anchorEl:n,onClose:a,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},r.a.createElement("h3",null,o,r.a.createElement($e.a,{sz:"xs",onClick:a},r.a.createElement(nt.a,{fontSize:"small"}))),t,r.a.createElement($e.a,{appearance:"default",onClick:c},s),r.a.createElement($e.a,{appearance:"primary",onClick:i},m))},rt=function(e){var t=e.commit,n=e.anchor,a=e.setAnchor,o=e.onFilterClick,c=e.onHistoryClick;return r.a.createElement(at,{anchor:n,setAnchor:a,title:t.toString(),onFilterClick:o,onHistoryClick:c,primaryBtn:"View Coverage"},r.a.createElement("p",null,"Author: ",t.getAuthor()," "),r.a.createElement("p",null,"Date: ",t.getDate().toDateString()," "),r.a.createElement("p",null,"SHA: ",t.getSHA()," "))},ot=function(e){var t=e.anchor,n=e.setAnchor,a=e.method,o=e.project,c=e.onFilterClick,i=e.onHistoryClick,l=a.getMethodName(),s=a.getPackageName(),u=o.getProjectName();return r.a.createElement(at,{anchor:t,setAnchor:n,title:l,onFilterClick:c,onHistoryClick:i,primaryBtn:"View History"},r.a.createElement("p",null,"Project: ",u," "),r.a.createElement("p",null,"Package: ",s))},ct=n(118),it=n.n(ct),lt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.a.createElement("div",null);return function(n){return n.isLoading?t:r.a.createElement(e,n)}}(w,r.a.createElement("div",{className:it.a.onLoadDiv},r.a.createElement("p",null,"Please select a project using the toolbar on the right."))),st=function(){var e=Object(a.useContext)(we),t=e.state,n=e.dispatch,o=E(t),c=null!==t.info.type?function(e){switch(e){case"COVERAGE":return{xLabel:"Methods",yLabel:"Tests"};case"TEST_HISTORY":return{xLabel:"Commits",yLabel:"Methods"};case"METHOD_HISTORY":return{xLabel:"Commits",yLabel:"Tests"};default:return{xLabel:null,yLabel:null}}}(t.info.type):{xLabel:null,yLabel:null},i=c.xLabel,l=c.yLabel,s={DEFAULT:r.a.createElement(Ye,null),COVERAGE:r.a.createElement(Ye,null),TEST_HISTORY:r.a.createElement(Ue,null),METHOD_HISTORY:r.a.createElement(Fe,null)};return ge(t.color_scheme,t.info.type,o,t.coverage),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:it.a.twoColumn},r.a.createElement(lt,{isLoading:t.isLoading,coverage:o,onXClick:function(e){n({type:je,filters:{METHOD_COOCCURENCE:Me(e.target.__data__)}})},onYClick:function(e){n({type:je,filters:{TEST_COEXECUTED:Ae(e.target.__data__)}})},onRightClick:function(e,t){e.preventDefault(),n({type:Te,pop_up:{isVisible:!0,label:t,anchor:e.target}})},xLabel:i,yLabel:l}),function(e,t,n,a){var o=e.pop_up.label;if(void 0!==o&&null!==o)return"Commit"===o.constructor.name?r.a.createElement(rt,{anchor:e.pop_up.anchor,setAnchor:function(){t({type:Te,pop_up:{isVisible:!1,label:null,anchor:null}})},commit:o,project:e.info.project,onFilterClick:n,onHistoryClick:a}):r.a.createElement(ot,{anchor:e.pop_up.anchor,setAnchor:function(){t({type:Te,pop_up:{isVisible:!1,label:null,anchor:null}})},method:o,project:e.info.project,onFilterClick:n,onHistoryClick:a})}(t,n,console.log,(function(){var e=t.pop_up.label.constructor.name;e===F.name?n({type:Ee,state:{type:"METHOD_HISTORY",info:{label:t.pop_up.label}}}):e===U.name?n({type:_e,state:{type:"TEST_HISTORY",info:{label:t.pop_up.label}}}):e===V.name&&n({type:be,commit:t.pop_up.label})}))),s[t.info.type])};n(362);var ut=function(){return r.a.createElement("div",{className:"app"},r.a.createElement(i.a,null,r.a.createElement(g,null),r.a.createElement("div",{className:"component"},r.a.createElement(Le,null,r.a.createElement(l.c,null,r.a.createElement(l.a,{exact:!0,path:"/",component:b}),r.a.createElement(l.a,{exact:!0,path:"/about",component:b}),r.a.createElement(l.a,{exact:!0,path:"/morpheus",component:st}))))),r.a.createElement(m,null))};n(363);c.a.render(r.a.createElement(ut,null),document.getElementById("root"))}},[[205,1,2]]]);
//# sourceMappingURL=main.a37bef3d.chunk.js.map